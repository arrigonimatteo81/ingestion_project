1) task jdbc 2 jdbc (gruppo "SEMAFORO") per portarmi su postgres il semaforo sqlserver: "public.semaforo_mensile"
    Attenzione, la tabella deve andare in overwrite, non in append in modo che venga semppre sovrascritta

2) la vista che esegue il seguente sql:
---------------------------------------
select
coalesce(rm.id,0) id_reg, sm.id id_sem,
sm.cod_abi as cod_abi,
sm.tabella as tabella,
sm.provenienza as provenienza,
sm.periodo_rif,
coalesce(rm.tipo_caricamento, sm.tipo_caricamento) as tipo_caricamento,
coalesce(rm.colonna_valore, sm.colonna_valore) as colonna_valore,
coalesce(rm.ambito, sm.ambito) as ambito,
coalesce(rm.max_datava, 20000101000000) as max_datava
from public.semaforo_mensile sm
left join public.registro_mensile rm
on sm.cod_abi = rm.cod_abi
and sm.tabella = rm.tabella
and sm.provenienza = rm.provenienza
where sm.id>coalesce(rm.id,0)
---------------------------------------
ritorna giá le righe che devono essere lette dall'orchestrator... conviene comunque fare una insert in overwrite
nella tab_tasks ed utilizzare quella

Al momento del lancio, l'orchestrator inserisce in append nella registro le righe della vista? Non mi sembra la soluzione
migliore, perché se qualcosa va storto, quella riga rimane dentro nella registro.
Conviene che le righe nella registro vengano inserite/aggiornate (ognuna per la sua riga di competenza)
alla fine dell'orchestrator solo se tutto é andato bene... la max_datava va presa dalla tabella di
staging perché è dovrebbe essere più veloce (considerando che il target dovrebbe essere BigQuery)

